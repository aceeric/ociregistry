
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://aceeric.github.io/ociregistry/test-driver/">
      
      
        <link rel="prev" href="../load-testing/">
      
      
        <link rel="next" href="../limitations/">
      
      
        
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.2">
    
    
      
        <title>Test Driver - Caching Pull-through OCI Distribution Server</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.484c7ddc.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../extra.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#test-driver" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="Caching Pull-through OCI Distribution Server" class="md-header__button md-logo" aria-label="Caching Pull-through OCI Distribution Server" data-md-component="logo">
      
  <img src="../assets/white-logo-no-background.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Caching Pull-through OCI Distribution Server
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Test Driver
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/aceeric/ociregistry" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="Caching Pull-through OCI Distribution Server" class="md-nav__button md-logo" aria-label="Caching Pull-through OCI Distribution Server" data-md-component="logo">
      
  <img src="../assets/white-logo-no-background.svg" alt="logo">

    </a>
    Caching Pull-through OCI Distribution Server
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/aceeric/ociregistry" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.1.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Overview
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-desktop/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start (Desktop)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-kubernetes/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Quick Start (Kubernetes)
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../configuring-the-server/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Configuring The Server
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../auth/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Authentication
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../command-line/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    The Command Line
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../loading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Loading And Preloading
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../pruning/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Pruning The Image Cache
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Design
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concur-design/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Concurrency Design
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../airgap-considerations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Airgap Considerations
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../rest-api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Administrative REST API
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../systemd/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Running as a systemd Service
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../observability/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Observability
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../load-testing/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Load Testing
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Test Driver
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Test Driver
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-arg-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed arg documentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-ociregistry-for-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Ociregistry for Test
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../limitations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Limitations
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#example" class="md-nav__link">
    <span class="md-ellipsis">
      
        Example
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#detailed-arg-documentation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Detailed arg documentation
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#configuring-ociregistry-for-test" class="md-nav__link">
    <span class="md-ellipsis">
      
        Configuring Ociregistry for Test
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="test-driver">Test Driver<a class="headerlink" href="#test-driver" title="Permanent link">&para;</a></h1>
<p>The test driver CLI supports load testing. It performs two types of tests depending on options provided on the command line:</p>
<ol>
<li>Pulling <em>through</em> an <em>Ociregistry</em> server <em>from</em> an upstream registry</li>
<li>Pulling only cached images from an <em>Ociregistry</em> server </li>
</ol>
<p>The CLI supports gradually scaling up and then scaling down the number of concurrent goroutines pulling from the server, and tallies the pull rate over time logging either to stdout or to a file.</p>
<p>Running with no args will display help. The following options are supported. Details are provided below the summary table:</p>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
<th>Other info</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--prune</code></td>
<td>Enables pruning.</td>
<td>Boolean - default false</td>
</tr>
<tr>
<td><code>--iteration-seconds VALUE</code></td>
<td>Seconds that a goroutine will run before the next goroutine is started (scale up) or stopped (scale down)</td>
<td>Default: 60</td>
</tr>
<tr>
<td><code>--tally-seconds VALUE</code></td>
<td>Interval for tallying pull rate</td>
<td>Default: 15</td>
</tr>
<tr>
<td><code>--patterns VALUE</code></td>
<td>Comma-separated batching go regex patterns</td>
<td>Can specify multiple. Aat least one is required. <code>*</code> is a valid pattern.</td>
</tr>
<tr>
<td><code>--metrics-file VALUE</code></td>
<td>Path to metrics output file</td>
<td><code>stdout</code> if omitted</td>
</tr>
<tr>
<td><code>--log-file VALUE</code></td>
<td>Path to log file</td>
<td><code>stdout</code> if omitted</td>
</tr>
<tr>
<td><code>--registry-url VALUE</code></td>
<td>Upstream registry URL (what <em>Ociregistry</em> server is pulling <strong>from</strong>)</td>
<td>Required</td>
</tr>
<tr>
<td><code>--pullthrough-url VALUE</code></td>
<td>Pull through URL (<em>Ociregistry</em> server under test)</td>
<td>Required</td>
</tr>
<tr>
<td><code>--filter VALUE</code></td>
<td>Repo filter</td>
<td>Optional go regex expression to create a smaller test set from the upstream registry.</td>
</tr>
<tr>
<td><code>--dry-run</code></td>
<td>Does everything except actually pull from the registry</td>
<td>Boolean - default false</td>
</tr>
<tr>
<td><code>--shuffle</code></td>
<td>If specified, then shuffles the image list between pull passes</td>
<td>Boolean - default false</td>
</tr>
</tbody>
</table>
<blockquote>
<p>Arguments can be specified in two ways: <code>--arg=value</code> or <code>--arg value</code>.</p>
</blockquote>
<h2 id="example">Example<a class="headerlink" href="#example" title="Permanent link">&para;</a></h2>
<p>In this example, the ociregistry server under test is available on <code>ubuntu.me:8080</code>, and it is pulling from an "upstream" registry available on <code>ubuntu.me:5000</code>:
<div class="highlight"><pre><span></span><code>go run .\
  --pullthrough-url=ubuntu.me:8080\
  --registry-url=ubuntu.me:5000\
  --patterns=-0001,-0002,-0003,-0004,-0005\
  --iteration-seconds=60\
  --tally-seconds=5\
  --dry-run
</code></pre></div></p>
<h2 id="detailed-arg-documentation">Detailed arg documentation<a class="headerlink" href="#detailed-arg-documentation" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th>Arg</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>Prune</td>
<td>If <code>true</code> then each goroutine will prune the images it pulled through the <em>Ociregistry</em> server on each pass before starting the next pass. This essentially forces the <em>Ociregistry</em> server under test to always be going to the upstream registry.</td>
</tr>
<tr>
<td>Iteration Seconds</td>
<td>This is the duration that the test driver will run each puller goroutine before the next goroutine is scaled up or down. Therefore, a test with 5 patterns, and 60 iteration seconds would take ten minutes: 5 minutes to scale up, and 5 minutes to scale down.</td>
</tr>
<tr>
<td>Tally Seconds</td>
<td>This is the sample interval used to determine the pull rate across all puller goroutines. Its the same idea as a prometheus scrape interval. Every <em>this</em> number of seconds the test driver will emanate the total pull rate across all puller goroutines.</td>
</tr>
<tr>
<td>Patterns</td>
<td>The patterns define the parallelism. For example, assume the upstream registry being pulled <em>from</em> has 1000 images and each image name contains a component like <code>-0001</code>, <code>-0002</code>, etc. E.g. <code>testimage-&lt;random number&gt;-0001:&lt;tag&gt;</code>, <code>testimage-&lt;random number&gt;-0002:&lt;tag&gt;</code>, etc. These patterns are specified on the command line as a comma-separated string. The test driver will start one goroutine to pull the <code>-0001</code> images. Then the second goroutine would pull the <code>-0002</code> images, and so on. So 10 patterns will result in 10 concurrently running goroutines each pulling their own filter. Note that <code>*,*,*,*,*</code> is a valid value for this arg.</td>
</tr>
<tr>
<td>Metrics File</td>
<td>The pull rate metrics are written to this file if specified, otherwise written to <code>stdout</code>.</td>
</tr>
<tr>
<td>Log File</td>
<td>Log messages are written to this file if specified, otherwise written to <code>stdout</code>.</td>
</tr>
<tr>
<td>Registry url</td>
<td>This is the "upstream" registry the <em>Ociregistry</em> server will pull <em>from</em>. It <strong>must</strong> be listening on HTTP. For example, I run the <code>registry</code> image in a container on port 5000, so: <code>registry-url=ubuntu.me:5000</code></td>
</tr>
<tr>
<td>Pull through url</td>
<td>This is the url of the <em>Ociregistry</em> server under test. Because the test driver currently only supports HTTP, <em>Ociregistry</em> <strong>must</strong> be listening on HTTP - and - you will have to configure the <em>Ociregistry</em> under test to pull from the upstream Registry (below) on HTTP. See the configuration exemplar below this table. Since <em>Ociregistry</em> runs on 8080 by default, then: <code>--pullthrough-url=ubuntu.me:8080</code></td>
</tr>
<tr>
<td>Filter</td>
<td>Allows to filter the images in the upstream registry (that <em>Ociregistry</em> is pulling <em>from</em>) <strong>before</strong> the test starts. Say your upstream registry has 1000 images and you know that the tags allow you to get a subset of that. You specify that filter here to get a smaller starting set. Otherwise, all 1000 images will be used for the test.</td>
</tr>
<tr>
<td>Dry Run</td>
<td>Does everything except pull through the <em>Ociregistry</em> server under test. (Instead, sleeps for a few milliseconds so as not to peg the CPU.) Also skips pruning.</td>
</tr>
<tr>
<td>Shuffle</td>
<td>If <code>true</code> then each goroutine will shuffle the image list on each iteration.</td>
</tr>
</tbody>
</table>
<h2 id="configuring-ociregistry-for-test">Configuring <em>Ociregistry</em> for Test<a class="headerlink" href="#configuring-ociregistry-for-test" title="Permanent link">&para;</a></h2>
<p>The test driver only supports HTTP at this time. The test driver gets its test set directly from the upstream registry that <em>Ociregistry</em> is pulling from. After getting the test set, then the test driver pulls through <em>Ociregistry</em> which pulls from the upstream. So since the upstream has to serve on HTTP, you have to configure <em>Ociregistry</em> to pull from the upstream over HTTP. The configuration example below accomplishes this via the <code>scheme</code> key:
<div class="highlight"><pre><span></span><code>cat &lt;&lt;EOF &gt; /tmp/test-config.yaml
registries:
  - name: ubuntu.me:5000
    description: The docker registry with the test images for Ociregistry to pull from
    scheme: http
EOF
</code></pre></div></p>
<p>Then: <code>ociregistry --config-file /tmp/test-config.yaml serve</code></p>
<p>By default, <em>Ociregistry</em> serves on HTTP so if run that way then it is automatically reachable by the test driver.</p>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../load-testing/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Load Testing">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Load Testing
              </div>
            </div>
          </a>
        
        
          
          <a href="../limitations/" class="md-footer__link md-footer__link--next" aria-label="Next: Limitations">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Limitations
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": "..", "features": ["navigation.footer", "content.code.copy"], "search": "../assets/javascripts/workers/search.2c215733.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.79ae519e.min.js"></script>
      
    
  </body>
</html>